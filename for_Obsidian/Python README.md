#venv  #comport 
[[Python]]


# VirtualCom

–≠–º—É–ª—è—Ç–æ—Ä COM-–ø–æ—Ä—Ç–∞ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ü–û, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ—Ä—Ç–∞–º–∏.

## –û–ø–∏—Å–∞–Ω–∏–µ

VirtualCom –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ü–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Ä–µ–∞–ª—å–Ω—ã–º COM-–ø–æ—Ä—Ç–∞–º (—Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º).
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (—Å–∫–æ—Ä–æ—Å—Ç—å, –±–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö, —á–µ—Ç–Ω–æ—Å—Ç—å, —Å—Ç–æ–ø-–±–∏—Ç—ã).
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –∏–ª–∏ HEX-—Ñ–æ—Ä–º–∞—Ç–µ.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å CRC16 (Modbus) –∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–º HEX-–¥–∞–Ω–Ω—ã–º.
- –ü—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö (HEX, ASCII, –æ–±–∞) —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏.
- –ü—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö.
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å –∑–∞–ø—É—Å–∫ –≤—Ç–æ—Ä–æ–π –∫–æ–ø–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å —Ç–µ–º –∂–µ –ø–æ—Ä—Ç–æ–º —Å –ø–æ–º–æ—â—å—é lock-—Ñ–∞–π–ª–æ–≤.

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `prompt_toolkit` –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à (–±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–∂–∏–º–∞—Ç—å Enter –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–ø—Ü–∏–π –º–µ–Ω—é –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ **—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** –¥–æ—Å—Ç—É–ø–Ω—ã—Ö COM-–ø–æ—Ä—Ç–æ–≤.
-   –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** (38400 –±–æ–¥, 8 –±–∏—Ç, –±–µ–∑ –ø–∞—Ä–∏—Ç–µ—Ç–∞, 1 —Å—Ç–æ–ø-–±–∏—Ç).
-   **–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä** –ø–æ—Ä—Ç–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–Ω–∞–∂–∞—Ç–∏–µ–º —Ü–∏—Ñ—Ä—ã).
-   –û—Ç–ø—Ä–∞–≤–∫–∞ **—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö** —Å–æ–æ–±—â–µ–Ω–∏–π (UTF-8).
-   –û—Ç–ø—Ä–∞–≤–∫–∞ **HEX-–¥–∞–Ω–Ω—ã—Ö**.
-   –û—Ç–ø—Ä–∞–≤–∫–∞ HEX-–¥–∞–Ω–Ω—ã—Ö —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞—Å—á–µ—Ç–æ–º –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º **CRC16 (Modbus)**.
-   –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
    -   –¢–æ–ª—å–∫–æ HEX (`HH:MM:SS –ü–æ—Ä—Ç üì• HEX: ...`)
    -   –¢–æ–ª—å–∫–æ ASCII (`HH:MM:SS –ü–æ—Ä—Ç üì• ASCII: ...`)
    -   –û–±–∞ —Ñ–æ—Ä–º–∞—Ç–∞ (`HH:MM:SS –ü–æ—Ä—Ç üì• HEX: ...`, `HH:MM:SS –ü–æ—Ä—Ç üì• ASCII: ...`)
-   –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ **–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫** (`HH:MM:SS`) –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–Ω—è—Ç—ã—Ö –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö (—á–µ—Ä–µ–∑ –ª–æ–≥) —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—à–∏–±–æ–∫.
-   **–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞** (`üõë`) –∏ **–≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** (`‚ñ∂Ô∏è`) –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö (—Å **–æ—á–∏—Å—Ç–∫–æ–π –±—É—Ñ–µ—Ä–∞** –ø—Ä–∏ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏).
-   **–û—á–∏—Å—Ç–∫–∞ —ç–∫—Ä–∞–Ω–∞** (`üßπ`).
-   –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Ü–∏—Ñ—Ä–∞–º–∏ (`1`-`7`).
-   –í—ã—Ö–æ–¥ –∏–∑ —Ä–µ–∂–∏–º–æ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ `Esc`.
-   –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ `Ctrl+C`.
-   –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ **—Å—Ç–∞—Ç—É—Å–∞** –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ **—Ç–µ–∫—É—â–µ–º –ø–æ—Ä—Ç–µ** –∏ –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –æ –≤—ã—Ö–æ–¥–µ –ø–æ–¥ –º–µ–Ω—é.
-   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–≥–æ —Ç–∞–π–º–∞—É—Ç–∞ –º–µ–∂–¥—É –±–∞–π—Ç–∞–º–∏ (`inter_byte_timeout`)** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –ø–æ–ª–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
-   **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Ä—Ç–∞:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ –≤—Ç–æ—Ä–æ–π –∫–æ–ø–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å —Ç–µ–º –∂–µ –ø–æ—Ä—Ç–æ–º —Å –ø–æ–º–æ—â—å—é **lock-—Ñ–∞–π–ª–æ–≤** (—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —É–¥–∞–ª–µ–Ω–∏–µ–º –∑–∞–≤–∏—Å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ).

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

-   Python 3.8+ (–∏–∑-–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `:=` –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö, —Ö–æ—Ç—è –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–ª—è –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö)
-   –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `pyserial`: `pip install pyserial`
-   –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `prompt_toolkit`: `pip install prompt_toolkit`
-   –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: macOS, Linux, Windows (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π).

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã.**
2.  **–°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
    ```bash
    python -m venv .venv 
    # macOS / Linux
    source .venv/bin/activate 
    # Windows (Command Prompt)
    # .venv\Scripts\activate.bat
    # Windows (PowerShell)
    # .venv\Scripts\Activate.ps1 
    ```
3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install pyserial prompt_toolkit
    ```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞:**
    (–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ)
    ```bash
    python vicom.py
    ```
2.  **–í—ã–±–µ—Ä–∏—Ç–µ COM-–ø–æ—Ä—Ç** –∏–∑ —Å–ø–∏—Å–∫–∞, –≤–≤–µ–¥—è –µ–≥–æ –Ω–æ–º–µ—Ä.
3.  **–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
    -   `1`: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–≤—ã–±–∏—Ä–∞–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–∂–∞—Ç–∏–µ–º —Ü–∏—Ñ—Ä).
    -   `2`: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
4.  **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–π—Ç–µ —Å –æ—Å–Ω–æ–≤–Ω—ã–º –º–µ–Ω—é:**
    -   `1`: –†–µ–∂–∏–º –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
    -   `2`: –†–µ–∂–∏–º –æ—Ç–ø—Ä–∞–≤–∫–∏ HEX –¥–∞–Ω–Ω—ã—Ö.
    -   `3`: –†–µ–∂–∏–º –æ—Ç–ø—Ä–∞–≤–∫–∏ HEX –¥–∞–Ω–Ω—ã—Ö —Å CRC16.
    -   `4`: `üõë` –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö.
    -   `5`: `‚ñ∂Ô∏è` –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö (–æ—á–∏—â–∞–µ—Ç –±—É—Ñ–µ—Ä).
    -   `6`: `üëÅÔ∏è` –°–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–û–±–∞ -> HEX -> ASCII -> –û–±–∞).
    -   `7`: `üßπ` –û—á–∏—Å—Ç–∏—Ç—å —ç–∫—Ä–∞–Ω.
    -   `Esc`: –í—ã—Ö–æ–¥ –∏–∑ —Ä–µ–∂–∏–º–æ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±—Ä–∞—Ç–Ω–æ –≤ –º–µ–Ω—é.
    -   `Ctrl+C`: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã.

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### macOS

1.  **–°–æ–∑–¥–∞–π—Ç–µ AppleScript:**
    -   –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–†–µ–¥–∞–∫—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤" (Script Editor).
    -   –í—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, **–∑–∞–º–µ–Ω–∏–≤ –ø—É—Ç–∏** –Ω–∞ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∫ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä—É Python –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏:

    ```applescript
    on run
        -- –ü–û–õ–ù–´–ô –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ, –≥–¥–µ –ª–µ–∂–∏—Ç –≤–∞—à —Å–∫—Ä–∏–ø—Ç vicom.py
        set scriptFolder to "/Users/olgazaharova/Project/Python/Python2Mac/VirtualCom/" -- <-- –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –í–ê–® –ü–£–¢–¨
        -- –ò–º—è –≤–∞—à–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
        set scriptName to "vicom.py"
        -- –ü–û–õ–ù–´–ô –ø—É—Ç—å –∫ –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¢–û–†–£ Python –í–ù–£–¢–†–ò –≤–∞—à–µ–≥–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
        set pythonPath to "/Users/olgazaharova/Project/Python/Python2Mac/VirtualCom/.venv/bin/python3" -- <-- –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –í–ê–® –ü–£–¢–¨ K PYTHON –í VENV
        -- –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–∞—à–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
        set theCommand to "cd " & quoted form of scriptFolder & " && " & quoted form of pythonPath & " " & quoted form of scriptName

        tell application "Terminal"
            activate
            -- 1. –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –æ–∫–Ω–æ/–≤–∫–ª–∞–¥–∫—É
            set targetTab to do script ""
            delay 0.7 

            try
                set targetWindow to window 1
                
                -- 2. –ò–∑–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å)
                set currentBounds to bounds of targetWindow
                set x1 to item 1 of currentBounds
                set y1 to item 2 of currentBounds
                set x2 to item 3 of currentBounds
                set y2 to item 4 of currentBounds
                set currentWidth to x2 - x1
                set currentHeight to y2 - y1
                set newWidth to round (currentWidth * 1.25) rounding as taught in school -- –®–∏—Ä–µ –Ω–∞ 25%
                set newHeight to round (currentHeight * 0.60) rounding as taught in school -- –ù–∏–∂–µ –Ω–∞ 40%
                set newX2 to x1 + newWidth
                set newY2 to y1 + newHeight
                set bounds of targetWindow to {x1, y1, newX2, newY2}
                delay 0.2 

                -- 3. –ò–∑–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å)
                tell application "System Events"
                    tell process "Terminal"
                        set frontmost of targetWindow to true
                        delay 0.1
                        keystroke "-" using command down -- –£–º–µ–Ω—å—à–∏—Ç—å —à—Ä–∏—Ñ—Ç (–ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ)
                        delay 0.1
                        keystroke "-" using command down
                        delay 0.1
                        keystroke "-" using command down
                    end tell
                end tell
                delay 0.2

                -- 4. –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—É Python –≤ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º –æ–∫–Ω–µ
                do script theCommand in targetTab 

            on error errMsg number errNum
                display dialog "–û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –æ–∫–Ω–∞/–∑–∞–ø—É—Å–∫–µ —Å–∫—Ä–∏–ø—Ç–∞: " & errMsg & " (" & errNum & ")"
            end try
            
        end tell
    end run
    ```
    -   –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç (`–§–∞–π–ª -> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å`) –∫–∞–∫ **–ü—Ä–æ–≥—Ä–∞–º–º—É** (Application) –Ω–∞ –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª –∏–ª–∏ –≤ –¥—Ä—É–≥–æ–µ —É–¥–æ–±–Ω–æ–µ –º–µ—Å—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `VirtualCom Launcher.app`).
2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É**, –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω—É–≤ –ø–æ –Ω–µ–π.

### Windows

**1.  –°–æ–∑–¥–∞—Ç—å —è—Ä–ª—ã–∫ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞ python —á–µ—Ä–µ–∑ powershell**
–°–æ–∑–¥–∞—Ç—å —è—Ä–ª—ã–∫ –Ω–∞ –†–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ –¥–ª—è  vicom.py –æ—Ç–∫—Ä—ã—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –∏–∑–º–µ–Ω–∏—Ç—å:
–û–±—ä–µ–∫—Ç —è—Ä–ª—ã–∫–∞
```txt
"C:\Program Files\PowerShell\7\pwsh.exe" -Command "& 'C:\Project\ProjectPython\Python2Mac\VirtualCom\.venv\Scripts\python.exe' 'C:\Project\ProjectPython\Python2Mac\VirtualCom\vicom.py'"
```
–†–∞–±–æ—á–∞—è –ø–∞–ø–∫–∞
```txt
"C:\Program Files\PowerShell\7"
```
–£–±–µ–¥–∏—Ç—Å—è —á—Ç–æ:
- –§–∞–π–ª `vicom.py` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.    
- –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –±—ã–ª–æ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ –≤ `.venv`.    
- –°—Ç–æ–∏—Ç `PowerShell 7` (–∞ –Ω–µ Windows PowerShell), —Ä–∞–∑ —Ç—ã —É–∫–∞–∑—ã–≤–∞–µ—à—å `C:\Program Files\PowerShell\7\pwsh.exe`.

–°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –≤ –ø–∞–ø–∫–µ C:\Project\ProjectPython\Python2Mac\VirtualCom
```powershell
cd 'C:\Project\ProjectPython\Python2Mac\VirtualCom'
python -m venv .venv
. .venv\Scripts\Activate.ps1
# –ï—Å–ª–∏ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ ‚Äî –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω—É–∂–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:
```powershell
pip install prompt_toolkit pyserial
```

==–ò–õ–ò –õ–£–ß–®–ï —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `requirements.txt`==

–£–∑–Ω–∞—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤:
```bash
pip freeze
```
 –û—Ç–∫—Ä–æ–π –ø–∞–ø–∫—É    C:\Project\ProjectPython\Python2Mac\VirtualCom
–°–æ–∑–¥–∞–π —Ç–∞–º —Ñ–∞–π–ª `requirements.txt`

```ini
prompt_toolkit==3.0.50
pyserial==3.5
wcwidth==0.2.13
```

==–¢–µ–ø–µ—Ä—å —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –¥—Ä—É–≥–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:==
```powershell
pip install -r requirements.txt
```

2.  **–°–æ–∑–¥–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—ã–π —Ñ–∞–π–ª (.bat):**

   -   –û—Ç–∫—Ä–æ–π—Ç–µ –ë–ª–æ–∫–Ω–æ—Ç.
   -   –í—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, **–∑–∞–º–µ–Ω–∏–≤ –ø—É—Ç–∏** –Ω–∞ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∫ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–∫—Ä–∏–ø—Ç—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
@echo off
REM –ü—É—Ç—å –∫ Python –∏–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
set VENV_PYTHON=C:\Project\GitPython\Python2Mac\VirtualCom\.venv\Scripts\python.exe

REM –ü—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç—É vicom.py
set SCRIPT_PATH=C:\Project\GitPython\Python2Mac\VirtualCom\vicom.py

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è python.exe
if not exist "%VENV_PYTHON%" (
    echo –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –ø—É—Ç–∏: %VENV_PYTHON%
    pause
    exit /b 1
)

REM –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ —á–µ—Ä–µ–∑ PowerShell 7
"C:\Program Files\PowerShell\7\pwsh.exe" -Command "& '%VENV_PYTHON%' '%SCRIPT_PATH%'"
pause
```

–ò–õ–ò —Ç–∞–∫–æ–π 

```bash
@echo off
 :: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ü–†–ê–í–ò–õ–¨–ù–´–ô –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
  set SCRIPT_DIR="C:\–ø—É—Ç—å\–∫\–≤–∞—à–µ–π\–ø–∞–ø–∫–µ\VirtualCom" 
  :: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ü–†–ê–í–ò–õ–¨–ù–´–ô –ø—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ venv
  set VENV_ACTIVATE=%SCRIPT_DIR%\.venv\Scripts\activate.bat

    :: –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
    cd /D %SCRIPT_DIR%
    if errorlevel 1 (
        echo –û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É %SCRIPT_DIR%
        pause
        exit /b 1
    )

    :: –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    call %VENV_ACTIVATE%
    if errorlevel 1 (
        echo –û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ %VENV_ACTIVATE%
        pause
        exit /b 1
    )

    :: –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç Python
    echo –ó–∞–ø—É—Å–∫ VirtualCom...
    python vicom.py

    :: –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –æ–∫–Ω–æ –∑–∞–∫—Ä–æ–µ—Ç—Å—è —Å–∞–º–æ)
    :: call .venv\Scripts\deactivate.bat
    
    echo.
    echo VirtualCom –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É.
    pause :: –û—Å—Ç–∞–≤–ª—è–µ–º –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã–º, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—ã–≤–æ–¥
```

-   –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª (`–§–∞–π–ª -> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫...`) —Å –∏–º–µ–Ω–µ–º `run_vicom.bat` (—É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∏–ø —Ñ–∞–π–ª–∞ "–í—Å–µ —Ñ–∞–π–ª—ã", –∞ –Ω–µ ".txt") –≤ –ø–∞–ø–∫—É –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ (`VirtualCom`).
3.  **–°–æ–∑–¥–∞–π—Ç–µ —è—Ä–ª—ã–∫ –Ω–∞ –†–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ:**
    -   –©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –Ω–∞ —Ñ–∞–π–ª–µ `run_vicom.bat` –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞.
    -   –í—ã–±–µ—Ä–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å" -> "–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª (—Å–æ–∑–¥–∞—Ç—å —è—Ä–ª—ã–∫)".
    -   –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª, –Ω–∞–π–¥–∏—Ç–µ –Ω–æ–≤—ã–π —è—Ä–ª—ã–∫ (`run_vicom.bat - –Ø—Ä–ª—ã–∫`).
    -   –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –µ–≥–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ "VirtualCom").
    -   (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –Ω–∞ —è—Ä–ª—ã–∫–µ -> "–°–≤–æ–π—Å—Ç–≤–∞" -> "–°–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–æ–∫..." –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –∏–∫–æ–Ω–∫—É.
4.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É**, –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω—É–≤ –ø–æ —è—Ä–ª—ã–∫—É –Ω–∞ –†–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è `vicom.py`.

## –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö

–í—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –¥–≤—É—Ö —Å—Ç—Ä–æ–∫–∞—Ö:

```
{–ò–º—è –ø–æ—Ä—Ç–∞} üì• –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å HEX: <–±–∞–π—Ç1> <–±–∞–π—Ç2> ...
{–ò–º—è –ø–æ—Ä—Ç–∞} üì• ASCII: <—Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ>
–ú–µ–Ω—é (Esc) –∏–ª–∏ –í—ã—Ö–æ–¥ (Ctrl+C): 
```

(–ù–µ–ø–µ—á–∞—Ç–∞–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ ASCII –∑–∞–º–µ–Ω—è—é—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º-–∑–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º).

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

-   –°–∫–æ—Ä–æ—Å—Ç—å: 38400 –±–æ–¥
-   –†–∞–∑–º–µ—Ä –±–∞–π—Ç–∞: 8 –±–∏—Ç
-   –ü–∞—Ä–∏—Ç–µ—Ç: –Ω–µ—Ç
-   –°—Ç–æ–ø-–±–∏—Ç—ã: 1

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–≠–º—É–ª—è—Ü–∏—è)

–î–ª—è —Ü–µ–ª–µ–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ—Ç –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã:

-   `01 02 03` -> –æ—Ç–≤–µ—Ç: `01 0C`
-   `41` -> –æ—Ç–≤–µ—Ç: `20 00`
-   `AA BB CC` -> –æ—Ç–≤–µ—Ç: `DD EE`
-   –ó–∞–ø—Ä–æ—Å—ã –¥–ª–∏–Ω–æ–π 3 –±–∞–π—Ç–∞, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å `01` -> –æ—Ç–≤–µ—Ç: –ø–µ—Ä–≤—ã–π –±–∞–π—Ç –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤—Ç–æ—Ä–æ–π –±–∞–π—Ç + 10

## –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã

–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –∫–ª–∞–≤–∏—à `Ctrl+C`. 